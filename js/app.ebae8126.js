(function(e){function t(t){for(var a,s,c=t[0],o=t[1],l=t[2],d=0,v=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&v.push(n[s][0]),n[s]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);u&&u(t);while(v.length)v.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,c=1;c<r.length;c++){var o=r[c];0!==n[o]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={app:0},i=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/pdok-services/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=o;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"010a":function(e,t,r){},"034f":function(e,t,r){"use strict";r("85ec")},"0df5":function(e,t,r){"use strict";r("2e66")},"0f76":function(e,t,r){"use strict";r("f6c9")},"11f5":function(e,t,r){"use strict";r("7592")},1333:function(e,t,r){"use strict";r("18af")},"18af":function(e,t,r){},"1c4d":function(e,t,r){"use strict";r("2ac3")},"2ac3":function(e,t,r){},"2e66":function(e,t,r){},3025:function(e,t){e.exports="data:image/png;base64,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"},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"nav"},[a("router-link",{attrs:{to:"/home"}},[a("img",{staticClass:"nav-image",attrs:{alt:"PDOK logo",src:r("3025")}})])],1),a("router-view")],1)},i=[],s=r("5530"),c=r("5935"),o={name:"App",components:{},computed:Object(s["a"])({},Object(c["b"])({cswBaseUrl:"cswBaseUrl"})),mounted:function(){}},l=o,u=(r("034f"),r("2877")),d=Object(u["a"])(l,n,i,!1,null,null,null),v=d.exports,p=r("8c4f"),m=r("2f62");a["a"].use(m["a"]);var f=new m["a"].Store({state:{cswBaseUrl:"https://nationaalgeoregister.nl/geonetwork/srv/dut/csw",serviceOwner:"Beheer PDOK",records:[],displayItems:[],cswLoaded:!1,fuse:{}},getters:{getField:c["a"]},mutations:{updateField:c["c"]},actions:{}}),h=r("4ae6"),y=r.n(h),w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search"},[e.cswLoaded?e._e():r("div",{attrs:{id:"loader"}},[r("div",{staticClass:"loader"}),r("p",[e._v("Loading records from "+e._s(e.cswBaseUrlHost))])]),e.cswLoaded?r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],attrs:{type:"text",placeholder:"search in "+e.records.length+" services from "+e.serviceOwner},domProps:{value:e.query},on:{change:e.search,input:function(t){t.target.composing||(e.query=t.target.value)}}}),r("p",{attrs:{id:"resultSummrary"}},[e._v(" "+e._s(e.displayItems.length)+" results in "+e._s(e.cswBaseUrlHost)+" ")]),r("div",{attrs:{id:"results"}},[r("ul",[e._l(e.displayItems,(function(e){return[r("list-item",{key:e.id,attrs:{item:e}})]}))],2)])]):e._e()])},g=[],b=(r("99af"),r("4160"),r("a15b"),r("d81d"),r("d3b7"),r("ac1f"),r("3ca3"),r("5319"),r("841c"),r("ddb0"),r("2b3d"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("router-link",{attrs:{tag:"li",to:{name:e.item.serviceType,params:{serviceId:e.item.id}}}},[e._v(e._s(e.item.title))])}),S=[],L={name:"ListItem",props:{item:{required:!0,type:Object}},computed:{},mounted:function(){}},_=L,O=(r("1c4d"),Object(u["a"])(_,b,S,!1,null,"206c8841",null)),C=O.exports,x=r("6062"),A=(r("159b"),r("96cf"),r("1da1")),j=function(){var e=Object(A["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,i,s,c,o,l,u,d,v,p,m,f,h=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=h.length>2&&void 0!==h[2]?h[2]:0,n="".concat(t,"?request=GetRecords&Service=CSW&Version=2.0.2&typeNames=gmd:MD_Metadata&resultType=hits&constraint=").concat(r,"&constraintLanguage=CQL_TEXT&constraint_language_version=1.1.0"),e.next=4,fetch(n);case 4:if(i=e.sent,i.ok){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,i.text();case 9:s=e.sent,c=new DOMParser,o=c.parseFromString(s,"text/xml"),l=o.querySelectorAll("SearchResults"),u=parseInt(l[0].getAttribute("numberOfRecordsMatched")),d=50,a<50&&a>0&&(d=a),v=1,p=[];case 18:if(m="".concat(t,"?request=GetRecords&Service=CSW&Version=2.0.2&typeNames=gmd:MD_Metadata&resultType=results&constraint=").concat(r,"&constraintLanguage=CQL_TEXT&constraint_language_version=1.1.0&startPosition=").concat(v,"&maxRecords=").concat(d),f=fetch(m),p.push(f),v+=d,!(v>u)){e.next=25;break}return e.abrupt("break",27);case 25:e.next=18;break;case 27:return e.abrupt("return",p);case 28:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),I=function(){var e=Object(A["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,i,s,c,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=o.length>2&&void 0!==o[2]?o[2]:0,n=[],i=j(t,r,a),e.next=5,i;case 5:return s=e.sent,e.next=8,Promise.all(s).then((function(e){return Promise.all(e.map((function(e){return e.text()}))).then((function(e){return e}))}));case 8:return c=e.sent,c.forEach((function(e){for(var t=new DOMParser,r=t.parseFromString(e,"text/xml"),a=r.querySelectorAll("SummaryRecord"),i=function(e){var t=a[e],r=t.querySelectorAll("identifier")[0].textContent,i=t.querySelectorAll("title")[0].textContent,s=t.querySelectorAll("abstract")[0].textContent,c=[];t.querySelectorAll("subject").forEach((function(e){c.push(e.textContent)}));var o={};o.title=i,o.id=r,o.abstract=s,o.keywords=c,n.push(o)},s=0;s<a.length;++s)i(s)})),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();function M(e){var t=e.querySelectorAll("connectPoint CI_OnlineResource linkage URL");return t&&t.length>0?t[0].textContent:""}function P(e){var t=e.querySelectorAll("onLine CI_OnlineResource protocol Anchor");return t&&0===t.length&&(t=e.querySelectorAll("onLine CI_OnlineResource protocol CharacterString")),t&&t.length>0?t[0].textContent:""}var U=function(){var e=Object(A["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,i,s,c,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="".concat(t,"?service=CSW&request=GetRecordById&version=2.0.2&outputSchema=http://www.isotc211.org/2005/gmd&elementSetName=full&id=").concat(r,"#MD_DataIdentification"),e.next=3,fetch(a);case 3:if(n=e.sent,n.ok){e.next=6;break}return e.abrupt("return","");case 6:return e.next=8,n.text();case 8:return i=e.sent,s=new DOMParser,c=s.parseFromString(i,"text/xml"),o=M(c),o=o.replace("http://","https://"),l=P(c),e.abrupt("return",{id:r,url:o,protocol:l});case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),E=function(){var e=Object(A["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,i,s,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=c.length>2&&void 0!==c[2]?c[2]:0,e.next=3,I(t,r,a);case 3:for(n=e.sent,i=function(e){var r=n[e],a=U(t,r.id);a.then((function(e){r.url=e}))},s=0;s<n.length;++s)i(s);return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),k={getCSWRecord:U,getCSWRecordsWithUrl:E,getCSWRecords:I,getRequests:j},G={name:"Search",components:{ListItem:C},data:function(){return{query:"",serviceTypes:""}},props:{},computed:Object(s["a"])(Object(s["a"])({},Object(c["b"])({records:"records",displayItems:"displayItems",cswLoaded:"cswLoaded",fuse:"fuse",cswBaseUrl:"cswBaseUrl",serviceOwner:"serviceOwner"})),{},{cswBaseUrlHost:function(){return new URL(this.cswBaseUrl).hostname}}),methods:{compare:function(e,t){return e.title<t.title?-1:e.title>t.title?1:0},getCQLQuery:function(e,t){return"type=%27service%27%20AND%20organisationName=%27".concat(e.replace(" ","%20"),"%27%20AND%20protocol=%27").concat(t.replace(" ","%20"),"%27")},search:function(){if(""!==this.query){var e=this.fuse.search(this.query,{});this.displayItems=e.map((function(e){var t=e.item;return t})).sort(this.compare)}else this.displayItems=this.records}},mounted:function(){var e=this;if(!this.cswLoaded){var t=this.$route.query.cswBaseUrl;t&&(this.cswBaseUrl=t);var r=[],a=["OGC:WMS","OGC:WFS","INSPIRE Atom","OGC:WMTS"];this.serviceTypes=a.join(", ");for(var n=0;n<a.length;n++)r.push(this.getCQLQuery(this.serviceOwner,a[n]));var i=[];r.forEach((function(t){i.push(k.getCSWRecords(e.cswBaseUrl,t))})),Promise.all(i).then((function(t){for(var r=[],n=function(e){r.push(t[e].map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{serviceType:a[e]})})))},i=0;i<t.length;i++)n(i);var c=[].concat.apply([],r);c.sort(e.compare),e.records=c,e.displayItems=c;var o={shouldSort:!0,threshold:.3,location:0,distance:100,minMatchCharLength:3,ignoreLocation:!0,keys:["title","abstract","keywords","id"]};e.fuse=new x["a"](e.records,o),e.cswLoaded=!0}))}}},F=G,T=(r("0df5"),Object(u["a"])(F,w,g,!1,null,"6b1bc76c",null)),N=T.exports,V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"relative"}},[e.cswLoaded?e._e():r("h2",[e._v("Loading...")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.capVis&&""!==e.capXml,expression:"capVis && capXml !== ''"}]},[r("div",{attrs:{id:"capbar"}},[r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:function(){return e.capXml},expression:"() => capXml"}]},[r("font-awesome-icon",{attrs:{icon:"clipboard"}})],1),r("button",{on:{click:function(t){e.capVis=!1}}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)]),r("prism",{attrs:{language:"xml"}},[e._v(" "+e._s(e.capXml)+" ")])],1),e.serviceInfoVis?r("div",[r("div",{attrs:{id:"capbar"}},[r("button",{on:{click:function(t){e.serviceInfoVis=!1}}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)]),r("service-info",{attrs:{serviceObject:e.serviceObject,record:e.record}})],1):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.capVis&&!e.serviceInfoVis,expression:"!capVis && !serviceInfoVis"}],attrs:{id:"container"}},[r("div",{attrs:{id:"main"}},[r("div",{ref:"map-root",attrs:{id:"map"}}),e.cswLoaded?r("div",{attrs:{id:"meta"}}):e._e()]),r("div",{attrs:{id:"mapControls"}},[r("div",{staticClass:"mapControl"},[e.serviceObject&&e.serviceObject.title?r("h3",[e._v(" "+e._s(e.serviceObject.title)+" ")]):e._e(),e._m(0)]),r("div",{staticClass:"mapControl"},[r("div",[r("label",[e._v("layer")]),e.cswLoaded?r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedLayer,expression:"selectedLayer"}],attrs:{disabled:!e.layers||e.layers.length<=1},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedLayer=t.target.multiple?r:r[0]}}},e._l(e.layers,(function(t){return r("option",{key:t.Name,domProps:{value:t}},[e._v(" "+e._s(t.Title)+" ")])})),0):e._e()]),r("div",[r("label",[e._v("style")]),e.cswLoaded?r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedStyle,expression:"selectedStyle"}],attrs:{disabled:!e.styles||e.styles.length<=1},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedStyle=t.target.multiple?r:r[0]}}},e._l(e.styles,(function(t){return r("option",{key:t.Name,domProps:{value:t}},[e._v(" "+e._s(t.Title)+" ")])})),0):e._e()]),r("div",[""!=e.maxScaleDenominator?r("button",{on:{click:e.zoomTo}},[r("font-awesome-icon",{attrs:{title:"Zoom to Layer",icon:"search-plus"}})],1):e._e(),r("button",{on:{click:function(t){e.serviceInfoVis=!0}}},[r("font-awesome-icon",{attrs:{title:"Show service info",icon:"info-circle"}})],1),r("button",{on:{click:function(t){e.capVis=!0}}},[r("font-awesome-icon",{attrs:{title:"Show capabilities document",icon:"file-code"}})],1)])]),""!==e.legendUrl?r("div",{staticClass:"mapControl"},[r("h3",[e._v("Legend")]),r("div",{staticStyle:{"overflow-x":"auto"}},[""!==e.legendUrl|void 0===e.legendUrl?r("img",{attrs:{id:"legend",src:e.legendUrl}}):e._e()])]):e._e(),e.selectedLayer?r("div",{staticClass:"mapControl"},[r("layer-info",{attrs:{itemType:"Layer",item:e.selectedLayer}})],1):e._e()])])])},W=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("dl",[r("dt",[e._v("service type")]),r("dd",[e._v("OGC:WMS")])])}],B=(r("4de4"),r("c740"),r("caad"),r("c975"),r("b64b"),r("2532"),r("1276"),r("a2c7")),R=r("5eee"),D=r("480c"),q=r("c810"),X=r("6792"),K=r("d0e9"),Z=r("41b9"),H=r("256f"),J=r("21bc"),Y=r("c320"),z=(r("5bc0"),r("ecee")),Q=r("c074"),$=r("ad3d"),ee=r("8d51"),te=r.n(ee);r("c197"),r("a878");function re(e){var t={title:e.Title,abstract:e.Abstract,keywords:e.KeywordList,fees:e.Fees,contactOrganization:e.ContactInformation.ContactPersonPrimary.ContactOrganization,contactName:e.ContactInformation.ContactPersonPrimary.ContactPerson,contactEmail:e.ContactInformation.ContactElectronicMailAddress};return t}function ae(e){var t={title:e.value.serviceIdentification.title[0].value,abstract:"",keywords:"",fees:"",contactOrganization:"",contactName:"",contactEmail:""};return t}function ne(e){var t={title:e.serviceIdentification.title[0].value,abstract:e.serviceIdentification._abstract[0].value,keywords:e.serviceIdentification.keywords.map((function(e){return e.keyword[0].value})),fees:e.serviceIdentification.fees,accessConstraints:e.serviceIdentification.accessConstraints[0],contactOrganization:e.serviceProvider.providerName,contactName:e.serviceProvider.serviceContact.individualName,contactEmail:e.serviceProvider.serviceContact.contactInfo.address.electronicMailAddress[0]};return t}var ie={getServiceInfoWMS:re,getServiceInfoWFS:ne,getServiceInfoWMTS:ae},se=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h3",[e._v(e._s(e.itemType)+" info")]),r("dl",[r("dt",[e._v("name")]),r("dd",[e._v(e._s(e.item.Name))]),r("dt",[e._v("title")]),r("dd",[e._v(e._s(e.item.Title))]),r("dt",[e._v("abstract")]),r("dd",[e._v(e._s(e.item.Abstract))])])])},ce=[],oe={name:"LayerInfo",props:{item:{required:!0,type:Object},itemType:{required:!0,type:String}},computed:{},mounted:function(){}},le=oe,ue=Object(u["a"])(le,se,ce,!1,null,"b1ab4b5e",null),de=ue.exports,ve=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"serviceInfo"}},[r("h3",[e._v("service info")]),r("dl",[r("dt",[e._v("title")]),r("dd",[e._v(e._s(e.serviceObject.title))]),r("dt",[e._v("service type")]),r("dd",[e._v(e._s(e.record.protocol))]),r("dt",[e._v("service url")]),r("dd",[r("a",{attrs:{href:e.getCapUrl}},[e._v(e._s(e.getCapUrl))])]),r("dt",[e._v("service metadata url")]),r("dd",[r("a",{attrs:{href:e.getHtmlMdUrl}},[e._v(e._s(e.getHtmlMdUrl))])]),r("dt",[e._v("abstract")]),r("dd",[e._v(e._s(e.serviceObject.abstract))]),r("dt",[e._v("keywords")]),e._l(e.serviceObject.keywords,(function(t){return r("dd",{key:t},[e._v(e._s(t))])})),r("dt",[e._v("fees")]),r("dd",[e._v(e._s(e.serviceObject.fees))]),r("dt",[e._v("accessconstraints")]),r("dd",[e._v(e._s(e.serviceObject.accessConstraints))]),r("dt",[e._v("contact organization")]),r("dd",[e._v(e._s(e.serviceObject.contactOrganization))]),r("dt",[e._v("contact name")]),r("dd",[e._v(e._s(e.serviceObject.contactName))]),r("dt",[e._v("contact email")]),r("dd",[e._v(e._s(e.serviceObject.contactEmail))])],2)])},pe=[],me={name:"ServiceInfo",props:{serviceObject:{required:!0,type:Object},record:{required:!0,type:Object}},methods:{getService:function(e){var t={"OGC:WMS":"WMS","OGC:WFS":"WFS"};return t[e]}},computed:Object(s["a"])(Object(s["a"])({},Object(c["b"])({cswBaseUrl:"cswBaseUrl",serviceOwner:"serviceOwner"})),{},{getHtmlMdUrl:function(){var e=this.cswBaseUrl.replace("csw","catalog.search");return"".concat(e,"#/metadata/").concat(this.record.id)},getCapUrl:function(){var e=this.record.url;e.includes("?")&&(e=e.split("?")[0]);var t=this.getService(this.record.protocol);return"".concat(e,"?request=GetCapabilities&service=").concat(t)}}),mounted:function(){}},fe=me,he=(r("9ccf"),Object(u["a"])(fe,ve,pe,!1,null,"7bb036cf",null)),ye=he.exports;z["c"].add([Q["a"],Q["f"],Q["e"],Q["c"],Q["d"]]);var we={name:"WMTSMap",components:{Prism:te.a,FontAwesomeIcon:$["a"],LayerInfo:de,ServiceInfo:ye},computed:Object(s["a"])(Object(s["a"])({},Object(c["b"])({cswBaseUrl:"cswBaseUrl",serviceOwner:"serviceOwner"})),{},{getCapUrl:function(){var e=this.record.url;return e.includes("?")&&(e=e.split("?")[0]),"".concat(e,"?request=GetCapabilities&service=WMS")},styles:function(){return this.selectedLayer?this.selectedLayer.Style:[]},maxScaleDenominator:function(){return void 0!==this.selectedLayer.MaxScaleDenominator?this.selectedLayer.MaxScaleDenominator:""},minScaleDenominator:function(){return Object.keys(this.selectedLayer).includes("MinScaleDenominator")?this.selectedLayer.MinScaleDenominator:""}}),data:function(){return{capVis:!1,serviceInfoVis:!1,olMap:null,serviceId:"",cswLoaded:!1,record:{},layers:[],selectedLayer:{},selectedStyle:{},olWmsLayer:{},legendUrl:"",serviceObject:{},capXml:""}},mounted:function(){var e=this;this.serviceId=this.$route.params.serviceId,k.getCSWRecord(this.cswBaseUrl,this.serviceId).then((function(t){e.record=t;var r=e.getCapUrl;fetch(r).then((function(e){return e.text()})).then((function(t){e.capXml=t;var r=new Z["a"],a=r.read(t);e.serviceObject=ie.getServiceInfoWMS(a.Service);var n=[];e.layers=e.unpackLayers(a.Capability,n),e.selectedLayer=e.layers[0],e.layers.forEach((function(e){e.Style=e.Style.filter((function(e,t,r){return r.findIndex((function(t){return t.Name===e.Name}))===t}))})),e.selectedStyle=e.layers[0].Style[0]})),e.cswLoaded=!0})),this.olMap=new R["a"]({controls:Object(J["a"])().extend([new Y["a"]]),target:this.$refs["map-root"],layers:[new D["a"]({source:new K["a"]})],view:new B["a"]({zoom:7,center:[681820.9487,6832242.7535],constrainResolution:!0})}),setTimeout((function(){e.olMap.updateSize()}),200),this.olMap.getView().on("change:resolution",(function(){e.updateLegendUrl()}))},watch:{selectedLayer:function(){this.switchLayer(),this.selectedStyle=this.selectedLayer.Style[0]},selectedStyle:function(){this.switchLayer()},capVis:function(){this.capVis&&this.olWmsLayer.render()}},methods:{zoomTo:function(){var e=39.37,t=96;if(!isNaN(this.maxScaleDenominator)){var r=this.maxScaleDenominator/(e*t);this.olMap.getView().setResolution(r)}},updateLegendUrl:function(){var e=this.olMap.getView().getResolution(),t=this.olWmsLayer.getSource().getLegendUrl(e);-1!==t.indexOf("&SCALE=NaN")&&(t=t.replace("&SCALE=NaN","")),t="".concat(t,"&SLD_VERSION=1.1.0"),t="".concat(t,"&STYLE=").concat(this.selectedStyle.Name),this.legendUrl=t},switchLayer:function(){this.olWmsLayer&&this.olMap.removeLayer(this.olWmsLayer),this.olWmsLayer=this.getLayer([this.selectedLayer.Name]),this.olMap.addLayer(this.olWmsLayer),this.olMap.render(),this.updateLegendUrl()},getLayer:function(){var e=[this.selectedLayer.Name],t=[this.selectedStyle.Name],r=new X["a"]({url:this.record.url.split("?")[0],params:{LAYERS:e.join(","),STYLES:t.join(",")},ratio:1,hidpi:!1,serverType:"mapserver",projection:Object(H["j"])("EPSG:3857")});return new q["a"]({source:r})},unpackLayers:function(e,t){var r=this;return Array.isArray(e)||(e=[e]),e.forEach((function(e){"Layer"in e?r.unpackLayers(e.Layer,t):t.push(e)})),t}}},ge=we,be=(r("11f5"),Object(u["a"])(ge,V,W,!1,null,"777b4036",null)),Se=be.exports,Le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"relative"}},[e.cswLoaded?e._e():r("h2",[e._v("Loading...")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.capVis&&""!==e.capXml,expression:"capVis && capXml !== ''"}]},[r("div",{attrs:{id:"capbar"}},[r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:function(){return e.capXml},expression:"() => capXml"}]},[r("font-awesome-icon",{attrs:{icon:"clipboard"}})],1),r("button",{on:{click:function(t){e.capVis=!1}}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)]),r("prism",{attrs:{language:"xml"}},[e._v(" "+e._s(e.capXml)+" ")])],1),e.serviceInfoVis?r("div",[r("div",{attrs:{id:"capbar"}},[r("button",{on:{click:function(t){e.serviceInfoVis=!1}}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)]),r("service-info",{attrs:{serviceObject:e.serviceObject,record:e.record}})],1):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.capVis&&!e.serviceInfoVis,expression:"!capVis && !serviceInfoVis"}],attrs:{id:"container"}},[r("div",{attrs:{id:"main"}},[r("div",{ref:"map-root",attrs:{id:"map"}}),e.cswLoaded?r("div",{attrs:{id:"meta"}}):e._e()]),r("div",{attrs:{id:"mapControls"}},[r("div",{staticClass:"mapControl"},[e.serviceObject&&e.serviceObject.title?r("h3",[e._v(" "+e._s(e.serviceObject.title)+" ")]):e._e(),e._m(0)]),r("div",{staticClass:"mapControl"},[r("div",[r("label",[e._v("layer")]),e.cswLoaded?r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedLayer,expression:"selectedLayer"}],attrs:{disabled:!e.layers||e.layers.length<=1},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedLayer=t.target.multiple?r:r[0]}}},e._l(e.layers,(function(t){return r("option",{key:t.identifier,domProps:{value:t}},[e._v(" "+e._s(t.identifier)+" ")])})),0):e._e()]),r("div",[r("button",{on:{click:function(t){e.serviceInfoVis=!0}}},[r("font-awesome-icon",{attrs:{title:"Show service info",icon:"info-circle"}})],1),r("button",{on:{click:function(t){e.capVis=!0}}},[r("font-awesome-icon",{attrs:{title:"Show capabilities document",icon:"file-code"}})],1)])]),""!==e.legendUrl?r("div",{staticClass:"mapControl"},[r("h3",[e._v("Legend")]),r("div",{staticStyle:{"overflow-x":"auto"}},[""!==e.legendUrl|void 0===e.legendUrl?r("img",{attrs:{id:"legend",src:e.legendUrl}}):e._e()])]):e._e(),e.selectedLayer?r("div",{staticClass:"mapControl"},[r("layer-info",{attrs:{itemType:"Layer",item:e.selectedLayerComp}})],1):e._e()])])])},_e=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("dl",[r("dt",[e._v("service type")]),r("dd",[e._v("OGC:WMTS")])])}],Oe=r("d510"),Ce=r("6ed8"),xe=r("0af5"),Ae=r("a79f"),je=r("f5dd"),Ie=r("bc81"),Me=r("486c"),Pe=r.n(Me);z["c"].add([Q["a"],Q["f"],Q["e"],Q["c"],Q["d"]]);var Ue=r("f529").OWS_1_1_0,Ee=r("f529").Filter_2_0,ke=r("a6c3").XLink_1_0,Ge=r("f529").WMTS_1_0,Fe=r("f529").GML_3_1_1,Te=r("f529").SMIL_2_0_Language,Ne=r("f529").SMIL_2_0,Ve={name:"WMSMap",components:{Prism:te.a,FontAwesomeIcon:$["a"],LayerInfo:de,ServiceInfo:ye},computed:Object(s["a"])(Object(s["a"])({},Object(c["b"])({cswBaseUrl:"cswBaseUrl",serviceOwner:"serviceOwner"})),{},{selectedLayerComp:function(){return{Title:this.selectedLayer.title,Abstract:this.selectedLayer.abstract,Name:this.selectedLayer.identifier}},getCapUrl:function(){var e=this.record.url;return e.includes("?")&&(e=e.split("?")[0]),"".concat(e,"?request=GetCapabilities&service=WMTS")},maxScaleDenominator:function(){return void 0!==this.selectedLayer.MaxScaleDenominator?this.selectedLayer.MaxScaleDenominator:""},minScaleDenominator:function(){return Object.keys(this.selectedLayer).includes("MinScaleDenominator")?this.selectedLayer.MinScaleDenominator:""}}),data:function(){return{capVis:!1,serviceInfoVis:!1,olMap:null,serviceId:"",cswLoaded:!1,record:{},layers:[],selectedLayer:{},olWmsLayer:{},legendUrl:"",serviceObject:{},capXml:"",projection:null,projectionExtent:null,resolutions:null,matrixIds:null}},mounted:function(){var e=this;this.serviceId=this.$route.params.serviceId,k.getCSWRecord(this.cswBaseUrl,this.serviceId).then((function(t){e.record=t;var r=e.getCapUrl;fetch(r).then((function(e){return e.text()})).then((function(t){var r=new Pe.a.Context([ke,Ee,Ue,Fe,Ge,Te,Ne]),a=r.createUnmarshaller(),n=a.unmarshalString(t);e.capXml=t,e.serviceObject=ie.getServiceInfoWMTS(n),e.layers=n.value.contents.datasetDescriptionSummary.map((function(t){return e.unpackWMTSLayer(t)})),e.selectedLayer=e.layers[0]})),e.cswLoaded=!0})),Ae["a"].defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs"),Object(Ie["a"])(Ae["a"]),this.projection=new je["a"]({code:"EPSG:28992",extent:[-285401.92,22598.08,595401.92,903401.92]}),this.projectionExtent=this.projection.getExtent();var t=Object(xe["E"])(this.projectionExtent)/256;this.resolutions=new Array(20),this.matrixIds=new Array(20);for(var r=0;r<20;++r)this.resolutions[r]=t/Math.pow(2,r),this.matrixIds[r]=r;var a="EPSG:28992";this.olMap=new R["a"]({controls:Object(J["a"])().extend([new Y["a"]]),target:this.$refs["map-root"],layers:[new D["a"]({opacity:.4,source:new Oe["a"]({attributions:"PDOK",url:"https://geodata.nationaalgeoregister.nl/tiles/service/wmts",layer:"brtachtergrondkaart",matrixSet:a,format:"image/png",projection:this.projection,tileGrid:this.getTileGrid(a),style:"default",wrapX:!0})})],view:new B["a"]({zoom:7,center:[681820.9487,6832242.7535],constrainResolution:!0})}),setTimeout((function(){e.olMap.updateSize()}),200)},watch:{selectedLayer:function(){this.switchLayer()},capVis:function(){this.capVis&&this.olWmsLayer.render()}},methods:{getTileGrid:function(e){var t=[3440.64,1720.32,860.16,430.08,215.04,107.52,53.76,26.88,13.44,6.72,3.36,1.68,.84,.42,.21,.105,.05025],r=new Array(15);if("EPSG:28992"===e)for(var a=0;a<15;++a)r[a]=a;else if("EPSG:28992:16"===e)for(var n=0;n<17;++n)r[n]=n;return new Ce["b"]({origin:Object(xe["C"])(this.projectionExtent),resolutions:t,matrixIds:r})},unpackWMTSLayer:function(e){var t=e.value;return{title:t.title[0].value,identifier:t.identifier.value,bbox:t.boundingBox[0].value.lowerCorner.join(",")+","+t.boundingBox[0].value.upperCorner.join(","),tileMatrixSets:t.tileMatrixSetLink.map((function(e){return e.tileMatrixSet})),style:t.style.map((function(e){return{identifier:e.identifier.value,isDefault:e.isDefault}}))}},switchLayer:function(){this.olWmsLayer&&this.olMap.removeLayer(this.olWmsLayer),this.olWmsLayer=this.getLayer(),this.olMap.addLayer(this.olWmsLayer),this.olMap.render()},getLayer:function(){var e="EPSG:28992";return this.selectedLayer.tileMatrixSets.includes("EPSG:28992:16")&&(e="EPSG:28992:16"),new D["a"]({opacity:1,source:new Oe["a"]({attributions:"PDOK",url:"https://geodata.nationaalgeoregister.nl/tiles/service/wmts",layer:this.selectedLayer.identifier,matrixSet:e,format:"image/png",projection:this.projection,tileGrid:this.getTileGrid(e),style:"default",wrapX:!0})})}}},We=Ve,Be=(r("1333"),Object(u["a"])(We,Le,_e,!1,null,"0d624048",null)),Re=Be.exports,De=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"relative"}},[e.cswLoaded?e._e():r("h2",[e._v("Loading...")]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.capVis&&""!==e.capXml,expression:"capVis && capXml !== ''"}]},[r("div",{attrs:{id:"capbar"}},[r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:function(){return e.capXml},expression:"() => capXml"}]},[r("font-awesome-icon",{attrs:{icon:"clipboard"}})],1),r("button",{on:{click:function(t){e.capVis=!1}}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)]),r("prism",{attrs:{language:"xml"}},[e._v(" "+e._s(e.capXml)+" ")])],1),e.serviceInfoVis?r("div",[r("div",{attrs:{id:"capbar"}},[r("button",{on:{click:function(t){e.serviceInfoVis=!1}}},[r("font-awesome-icon",{attrs:{icon:"times"}})],1)]),r("service-info",{attrs:{serviceObject:e.serviceObject,record:e.record}})],1):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.capVis&&!e.serviceInfoVis,expression:"!capVis && !serviceInfoVis"}],attrs:{id:"container"}},[r("div",{attrs:{id:"main"}},[r("div",{ref:"map-root",attrs:{id:"map"}}),r("div",{directives:[{name:"show",rawName:"v-show",value:e.currentCoordinate,expression:"currentCoordinate"}],ref:"popup",staticClass:"popup"},[r("span",{staticClass:"icon-close",on:{click:e.closePopup}},[e._v("âœ–")]),r("div",{staticClass:"content",domProps:{innerHTML:e._s(e.featureInfo)}})]),e.cswLoaded?r("div",{attrs:{id:"meta"}}):e._e()]),r("div",{attrs:{id:"mapControls"}},[r("div",{staticClass:"mapControl"},[e.serviceObject&&e.serviceObject.title?r("h3",[e._v(" "+e._s(e.serviceObject.title)+" ")]):e._e(),e._m(0)]),r("div",{staticClass:"mapControl"},[r("h3"),r("div",[r("button",{on:{click:function(t){e.serviceInfoVis=!0}}},[r("font-awesome-icon",{attrs:{title:"Show service info",icon:"info-circle"}})],1),r("button",{attrs:{title:"Show capabilities document"},on:{click:function(t){e.capVis=!0}}},[r("font-awesome-icon",{attrs:{icon:"file-code"}})],1),r("button",{attrs:{title:"Load features on map"},on:{click:function(t){return e.loadFeatures()}}},[r("font-awesome-icon",{attrs:{icon:"download"}})],1)]),r("div",[e.cswLoaded?r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedFeature,expression:"selectedFeature"}],attrs:{disabled:e.features.length<=1},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedFeature=t.target.multiple?r:r[0]}}},e._l(e.features,(function(t){return r("option",{key:t.Name,domProps:{value:t}},[e._v(" "+e._s(t.Title)+" ")])})),0):e._e()]),r("div",[r("label",[e._v("maxFeatures")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.maxFeatures,expression:"maxFeatures"}],attrs:{type:"number"},domProps:{value:e.maxFeatures},on:{input:function(t){t.target.composing||(e.maxFeatures=t.target.value)}}})])]),r("div",{staticClass:"mapControl"},[r("layer-info",{attrs:{itemType:"FeatureType",item:e.selectedFeature}})],1)])])])},qe=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("dl",[r("dt",[e._v("service type")]),r("dd",[e._v("OGC:WFS")])])}],Xe=(r("b0c0"),r("25f0"),r("a2e1")),Ke=r("5831"),Ze=r("3e6b"),He=r("0710"),Je=r("6c77"),Ye=r("8682"),ze=r("83a6"),Qe=r("ce2c"),$e=[255,255,255,1],et=[0,153,255,1],tt=2,rt=[new Je["b"]({stroke:new Ye["a"]({color:$e,width:tt+2})}),new Je["b"]({stroke:new Ye["a"]({color:et,width:tt})})],at=[new Je["b"]({fill:new ze["a"]({color:[255,255,255,.5]})}),new Je["b"]({stroke:new Ye["a"]({color:$e,width:3.5})}),new Je["b"]({stroke:new Ye["a"]({color:et,width:2.5})})],nt=[new Je["b"]({image:new Qe["a"]({radius:2*tt,fill:new ze["a"]({color:et}),stroke:new Ye["a"]({color:$e,width:tt/2})})})],it={pointStyle:nt,linestringStyle:rt,polygonStyle:at};z["c"].add([Q["f"],Q["a"],Q["c"],Q["b"]]);var st=r("f529").WFS_2_0,ct=r("f529").OWS_1_1_0,ot=r("f529").Filter_2_0,lt=r("a6c3").XLink_1_0,ut={name:"WFSMap",components:{Prism:te.a,FontAwesomeIcon:$["a"],LayerInfo:de,ServiceInfo:ye},computed:Object(s["a"])(Object(s["a"])({},Object(c["b"])({cswBaseUrl:"cswBaseUrl",serviceOwner:"serviceOwner"})),{},{getCapUrl:function(){var e=this.record.url;return e.includes("?")&&(e=e.split("?")[0]),"".concat(e,"?request=GetCapabilities&service=WFS&version=2.0.0")},getFeatureUrl:function(){var e=this.record.url;return e.includes("?")&&(e=e.split("?")[0]),"".concat(e,"?request=GetFeature&service=WFS&version=2.0.0&outputFormat=application/json&srsname=EPSG:3857")}}),data:function(){return{capVis:!1,olMap:null,vectorLayer:null,serviceId:"",cswLoaded:!1,record:{},features:[],selectedFeature:{},serviceObject:{},maxFeatures:1e3,capXml:"",overlay:null,featureInfo:"",currentCoordinate:null,serviceInfoVis:!1}},mounted:function(){var e=this;this.serviceId=this.$route.params.serviceId,k.getCSWRecord(this.cswBaseUrl,this.serviceId).then((function(t){e.record=t;var r=e.getCapUrl;fetch(r).then((function(e){return e.text()})).then((function(t){e.capXml=t;var r=new Pe.a.Context([lt,ot,ct,st]),a=r.createUnmarshaller(),n=a.unmarshalString(t);e.serviceObject=ie.getServiceInfoWFS({serviceIdentification:n.value.serviceIdentification,serviceProvider:n.value.serviceProvider}),e.features=[],n.value.featureTypeList.featureType.forEach((function(t){var r="".concat(t.name.prefix,":").concat(t.name.localPart),a=t.title[0].value,n=t._abstract[0].value;e.features.push({Name:r,Title:a,Abstract:n})})),e.selectedFeature=e.features[0]})),e.cswLoaded=!0})),this.overlay=new He["a"]({element:this.$refs.popup,autoPan:!0,autoPanAnimation:{duration:250}}),this.olMap=new R["a"]({target:this.$refs["map-root"],overlays:[this.overlay],controls:Object(J["a"])().extend([new Y["a"]]),layers:[new D["a"]({source:new K["a"]})],view:new B["a"]({zoom:7,center:[681820.9487,6832242.7535],constrainResolution:!0})}),this.olMap.on("click",(function(t){var r=t.coordinate;if(e.currentCoordinate)e.closePopup();else{e.currentCoordinate=r;var a=e.olMap.getFeaturesAtPixel(t.pixel,{layerFilter:function(t){return t===e.vectorLayer}});if(a.length>0){var n=a[0],i=n.getProperties();delete i.geometry,Object.keys(n).includes("id_")&&!Object.keys(i).includes("id")&&(i["id"]=n.id_);var s=e.genTableFromKVPs(i);e.featureInfo=s.outerHTML,setTimeout((function(){e.overlay.setPosition(r)}),0)}else e.featureInfo=""}})),setTimeout((function(){e.olMap.updateSize()}),200)},watch:{},methods:{closePopup:function(){this.overlay.setPosition(void 0),this.currentCoordinate=null},genTableFromKVPs:function(e){var t=document.createElement("table");return t.classList.add("styled-table"),Object.keys(e).forEach((function(r){var a=document.createElement("tr"),n=document.createElement("td"),i=document.createElement("td"),s=e[r];i.innerText=null!==s?s.toString():"null ",n.innerText=r.toString(),a.appendChild(n),a.appendChild(i),t.appendChild(a)})),t},geometryStyle:function(e){var t={MultiPolygon:it.polygonStyle,Polygon:it.polygonStyle,MultiLineString:it.linestringStyle,LineString:it.linestringStyle,Point:it.pointStyle,MultiPoint:it.pointStyle},r=e.getGeometry().getType();return t[r]},loadFeatures:function(){var e=this,t=this.olMap.getView().calculateExtent(),r=t.join(","),a="".concat(this.getFeatureUrl,"&count=").concat(this.maxFeatures,"&typename=").concat(this.selectedFeature.Name,"&bbox=").concat(r,",EPSG:3857");fetch(a).then((function(e){return e.json()})).then((function(t){var r=new Ke["a"]({features:(new Xe["a"]).readFeatures(t)});e.vectorLayer&&e.olMap.removeLayer(e.vectorLayer),e.vectorLayer=new Ze["a"]({source:r,style:e.geometryStyle}),e.olMap.addLayer(e.vectorLayer)}))}}},dt=ut,vt=(r("0f76"),Object(u["a"])(dt,De,qe,!1,null,"4014e2d8",null)),pt=vt.exports,mt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{attrs:{id:"content"},domProps:{innerHTML:e._s(e.feedHtml)},on:{click:e.handleClick}})])},ft=[],ht={name:"Atom",components:{},computed:Object(s["a"])({},Object(c["b"])({cswBaseUrl:"cswBaseUrl",serviceOwner:"serviceOwner"})),data:function(){return{capVis:!1,capXml:"",xslt:"",serviceId:"",cswLoaded:!1,record:{},serviceObject:{},dataFeedObjects:[],feedHtml:""}},mounted:function(){var e=this;this.serviceId=this.$route.params.serviceId;var t=this.cswBaseUrl;k.getCSWRecord(t,this.serviceId).then((function(t){e.record=t;var r=e.record.url,a=[];a.push(fetch(r)),a.push(fetch("/style.xslt")),Promise.all(a).then((function(t){Promise.all(t.map((function(e){return e.text()}))).then((function(t){e.capXml=t[0],e.xslt=t[1],e.updateHtml()}))})),e.cswLoaded=!0}))},watch:{},methods:{updateHtml:function(){var e=new DOMParser,t=e.parseFromString(this.xslt,"text/xml"),r=new XSLTProcessor;r.importStylesheet(t);var a=e.parseFromString(this.capXml,"text/xml"),n=r.transformToDocument(a),i=new XMLSerializer;this.feedHtml=i.serializeToString(n)},updateAtomHTLM:function(e){var t=this;fetch(e).then((function(e){return e.text()})).then((function(e){t.capXml=e,t.updateHtml()}))},handleClick:function(e){if(e.target.matches("a.atom-feed"))return e.preventDefault(),void this.updateAtomHTLM(e.target.href);if(e.target.matches("a.html-md")){e.preventDefault();var t=new URL(e.target.href),r="";t.searchParams.get("id")?r=t.searchParams.get("id"):t.searchParams.get("uuid")&&(r=t.searchParams.get("uuid"));var a="".concat(t.protocol,"//").concat(t.host,"/geonetwork/srv/dut/catalog.search#/metadata/").concat(r);window.location.href=a}}}},yt=ht,wt=(r("9fd9"),Object(u["a"])(yt,mt,ft,!1,null,null,null)),gt=wt.exports;a["a"].use(p["a"]),a["a"].use(y.a),a["a"].config.productionTip=!1;var bt=[{path:"/home",component:N},{path:"/wms-service/:serviceId",component:Se,name:"OGC:WMS"},{path:"/wfs-service/:serviceId",component:pt,name:"OGC:WFS"},{path:"/wmts-service/:serviceId",component:Re,name:"OGC:WMTS"},{path:"/atom-service/:serviceId",component:gt,name:"INSPIRE Atom"},{path:"/",redirect:"/home"},{path:"*",redirect:"home"}],St=new p["a"]({routes:bt});new a["a"]({store:f,router:St,render:function(e){return e(v)}}).$mount("#app")},7592:function(e,t,r){},"85ec":function(e,t,r){},"9ccf":function(e,t,r){"use strict";r("010a")},"9fd9":function(e,t,r){"use strict";r("e036")},e036:function(e,t,r){},f6c9:function(e,t,r){}});
//# sourceMappingURL=app.ebae8126.js.map